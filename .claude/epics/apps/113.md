---
created: 2025-10-03T18:53:58Z
updated: 2025-10-03T19:15:10Z
status: open
task_id: 001
title: 目录结构创建和文件移动
size: S
estimation: 30分钟
parallel: false
depends_on: []
github: https://github.com/ycc-im/noteum/issues/113
---

# Task 001: 目录结构创建和文件移动

## 概述

使用 `git mv` 命令将当前错误放置在 `packages/` 目录下的应用程序移动到正确的 `apps/` 目录结构。这是整个架构重构的基础任务，所有后续任务都依赖于此任务的完成。

## 技术细节

### 目标目录结构
```
apps/
├── web/         (from packages/web)
├── desktop/     (from packages/tauri)
└── server/      (from packages/server)

packages/ (保留)
├── shared/      (保持不变)
└── ui/          (保持不变)
```

### 文件移动策略

使用 `git mv` 确保：
- 保持完整的 Git 历史记录
- 避免大量 diff 噪音
- 支持快速回滚
- 维护文件权限和属性

### 执行步骤

1. **创建 apps 目录**
   ```bash
   mkdir -p apps
   ```

2. **移动应用程序**
   ```bash
   git mv packages/web apps/web
   git mv packages/tauri apps/desktop
   git mv packages/server apps/server
   ```

3. **验证移动结果**
   ```bash
   ls -la apps/
   ls -la packages/
   ```

## 验收标准

### 基本要求
- [ ] `apps/` 目录已创建
- [ ] `packages/web` → `apps/web` 移动完成
- [ ] `packages/tauri` → `apps/desktop` 移动完成
- [ ] `packages/server` → `apps/server` 移动完成
- [ ] `packages/shared` 和 `packages/ui` 保持不变

### Git 历史验证
- [ ] `git log --follow apps/web/package.json` 显示完整历史
- [ ] `git log --follow apps/desktop/package.json` 显示完整历史
- [ ] `git log --follow apps/server/package.json` 显示完整历史
- [ ] `git status` 显示重命名操作而非删除/添加

### 文件完整性
- [ ] 所有源文件保持完整（无缺失）
- [ ] 文件权限保持不变
- [ ] 目录结构内部保持不变

## 风险控制

### 预防措施
- 在执行前创建 Git 分支备份
- 使用 `git mv` 而非手动复制
- 逐个移动并验证每步

### 回滚计划
如果出现问题，可以使用：
```bash
git reset --hard HEAD~1
```

### 依赖影响
此任务完成后，以下组件需要更新：
- 根 package.json 的 workspace 配置
- 构建脚本路径引用
- 应用间的相对路径引用

## 技术约束

### 环境要求
- Git 版本 >= 2.0
- 对项目根目录有写权限
- 当前工作目录为项目根目录

### 操作限制
- 必须使用 `git mv` 命令
- 不允许手动复制/删除
- 不允许修改文件内容

## 完成定义

任务被认为完成当：

1. **目录结构正确**
   - `apps/web/`, `apps/desktop/`, `apps/server/` 存在
   - `packages/shared/`, `packages/ui/` 仍然存在
   - `packages/web/`, `packages/tauri/`, `packages/server/` 不存在

2. **Git 历史完整**
   - 所有文件的提交历史都可追溯
   - `git status` 显示重命名操作

3. **文件完整性**
   - 移动的应用程序目录内容完全一致
   - 无文件丢失或损坏

4. **准备后续任务**
   - 目录结构为后续配置更新任务做好准备
   - 无阻塞后续任务执行的问题

## 注意事项

- 此任务设置为 `parallel: false`，因为所有后续任务都依赖于它
- 移动完成后，现有的 dev/build 命令会暂时失效，这是正常的
- Task 002 将负责修复配置问题
