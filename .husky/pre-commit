#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run linting to check formatting
echo "ğŸ¨ Running Prettier formatting check..."
if ! pnpm lint; then
  echo "ğŸ“ Formatting issues found. Auto-fixing with Prettier..."
  npx prettier --write .
  
  echo "ğŸ” Re-running lint check after auto-fix..."
  if ! pnpm lint; then
    echo "âŒ Formatting issues still exist after auto-fix. Please review and fix manually."
    exit 1
  else
    echo "âœ… Formatting issues have been auto-fixed. Please add the changes and commit again."
    git add .
    echo "â„¹ï¸  Files have been auto-formatted and staged. You can now commit again."
    exit 1
  fi
fi

echo "âœ… All files are properly formatted!"