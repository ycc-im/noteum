# Feature Specification: 端口规范化和开发环境升级

**Feature Branch**: `003-3000-1-9158`
**Created**: 2025-10-15
**Status**: Draft
**Input**: User description: "我发现前后端默认使用了相同的端口号3000， 所能我认为需要设定，考虑到这些端口号容易和其他项目的端口冲突，我认为应该把我们的所有项目的端口号都规范一下：1 前端开发的用 9158， 2.后端用9168， 3，redis的为 9178, 4.pgsql的设定为 9198, 5.pgadmin的为 9188 . 另外，考虑到现在只有前端client项目没有在开发容器中，我认为可以把现在的开发容器提升等级到全系统并且加入前端开发的容器。"

## User Scenarios & Testing _(mandatory)_

### User Story 1 - 端口冲突解决 (Priority: P1)

开发者可以在不同的项目间同时工作，而不会遇到端口冲突问题。

**Why this priority**: 端口冲突是日常开发中的常见问题，会严重影响开发效率，解决此问题是开发环境稳定性的基础。

**Independent Test**: 可以通过同时启动多个项目验证端口不冲突，每个服务都能正常访问。

**Acceptance Scenarios**:

1. **Given** 开发者启动前端开发服务器，**When** 访问 http://localhost:9158，**Then** 前端应用正常加载
2. **Given** 开发者启动后端服务，**When** 访问 http://localhost:9168，**Then** 后端服务正常响应
3. **Given** 前后端服务同时运行，**When** 访问各自端口，**Then** 两个服务都能正常工作，没有端口冲突错误

---

### User Story 2 - 统一开发环境 (Priority: P1)

开发者可以通过一键启动命令启动完整的开发环境，包括前端、后端和所有依赖服务。

**Why this priority**: 统一的开发环境确保所有团队成员使用相同的配置，减少"在我机器上能运行"的问题。

**Independent Test**: 可以通过一键启动命令启动所有服务，验证每个服务都按预期端口运行。

**Acceptance Scenarios**:

1. **Given** 开发者运行开发环境启动命令，**When** 所有服务启动完成，**Then** 前端服务运行在9158端口，后端在9168端口
2. **Given** 开发环境运行中，**When** 检查服务状态，**Then** 缓存服务运行在9178端口，数据库在9198端口，管理界面在9188端口
3. **Given** 新团队成员加入项目，**When** 按照快速启动指南操作，**Then** 能够成功启动完整的开发环境

---

### User Story 3 - 开发环境隔离 (Priority: P2)

开发者可以在隔离的环境中进行开发，确保本地环境干净且不受项目依赖影响。

**Why this priority**: 环境隔离减少了依赖冲突和环境配置问题，提高了开发体验的一致性。

**Independent Test**: 可以通过开发环境内外对比验证隔离效果，以及通过不同项目的并行开发验证环境隔离。

**Acceptance Scenarios**:

1. **Given** 开发者本地没有安装开发工具或数据库，**When** 启动开发环境，**Then** 所有服务都能正常运行
2. **Given** 开发者同时处理多个项目，**When** 在不同项目目录启动对应开发环境，**Then** 各项目的端口和服务互不干扰
3. **Given** 开发环境运行中，**When** 检查进程和端口占用，**Then** 只有开发环境内的服务在运行，没有污染本地环境

---

### Edge Cases

- 当系统上的9158-9198端口被其他程序占用时如何处理？
- 开发环境启动失败时的回退机制是什么？
- 如何处理开发环境内外的文件同步问题？
- 如何在开发环境内进行调试和日志查看？

## Requirements _(mandatory)_

### Functional Requirements

- **FR-001**: 系统必须将前端开发服务器配置为使用端口9158
- **FR-002**: 系统必须将后端服务配置为使用端口9168
- **FR-003**: 系统必须将缓存服务配置为使用端口9178
- **FR-004**: 系统必须将数据库服务配置为使用端口9198
- **FR-005**: 系统必须将数据库管理界面配置为使用端口9188
- **FR-006**: 开发环境必须支持一键启动所有服务
- **FR-007**: 前端开发环境必须支持热重载功能
- **FR-008**: 前端服务必须能够访问后端服务
- **FR-009**: 开发环境必须支持本地文件挂载以实现代码编辑
- **FR-010**: 系统必须提供端口冲突检测和解决指导

### Key Entities _(include if feature involves data)_

- **端口配置**: 各服务的端口号映射和配置信息
- **服务配置**: 定义服务间依赖和网络配置
- **开发环境**: 包含前端、后端开发所需工具的环境
- **环境配置**: 开发、测试、生产环境的差异化配置

## Success Criteria _(mandatory)_

### Measurable Outcomes

- **SC-001**: 开发者可以在2分钟内完成完整开发环境的启动
- **SC-002**: 端口冲突相关的开发问题减少95%以上
- **SC-003**: 新团队成员的环境设置时间减少80%（从平均30分钟降至6分钟以内）
- **SC-004**: 支持至少3个不同项目在同一台机器上并行开发而无端口冲突
- **SC-005**: 开发环境启动成功率在标准开发机器上达到99%以上
- **SC-006**: 前端热重载响应时间在开发环境下保持在1秒以内
